$("#confirmCierreBtn").on("click",function(){let o=!0;if($(".iFaltante").each(function(){if(!$(this).val())return o=!1,!1}),!o){Swal.fire({title:"Error",text:"Todos los campos deben estar llenos antes de continuar.",icon:"error",confirmButtonText:"Aceptar"});return}let e=0;$(".montofaltante").each(function(){const t=parseFloat($(this).text()||$(this).val()||0);isNaN(t)||(e+=t)}),e>0?Swal.fire({title:"¿Está seguro de continuar?",text:`El monto faltante es ${Math.abs(e)}. ¿Desea continuar?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, continuar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed?n(e):console.log("Operación cancelada.")}):e<0?Swal.fire({title:"¿Está seguro de continuar?",text:`El sobrante es de ${e}. ¿Desea continuar?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, continuar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed?n(e):console.log("Operación cancelada.")}):n(e)});function n(o){Swal.fire({title:"Procesando...",text:"Por favor, espere mientras se completa el cierre de caja.",icon:"info",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{Swal.showLoading()}}),$.ajax({url:"CerrarCaja",method:"POST",data:{total:totalMetodosPago,diferencia:o*-1,comentarios:$("#comentariosCierre").val()||"N/A",idVentas},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){console.log(e),location.reload()},error:function(e,t,a){Swal.fire({title:"Error",text:"Hubo un problema al completar el cierre de caja. Intente nuevamente.",icon:"error",confirmButtonText:"Aceptar"}),console.error("Error:",a)}})}
